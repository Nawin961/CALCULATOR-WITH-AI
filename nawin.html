<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Beautiful Single-file Calculator</title>
  <style>
    :root{
      --bg:#0f1724; /* dark navy */
      --card:#0b1220;
      --glass: rgba(255,255,255,0.04);
      --accent:#7c5cff;
      --accent-2:#4ee0c9;
      --muted:rgba(255,255,255,0.65);
      --danger:#ff6b6b;
      --glass-2: rgba(255,255,255,0.03);
      --shadow: 0 10px 30px rgba(2,6,23,0.6);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(800px 400px at 10% 10%, rgba(124,92,255,0.12), transparent),
                  radial-gradient(600px 300px at 90% 90%, rgba(78,224,201,0.06), transparent),
                  var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:36px;
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      width:380px;
      max-width:96vw;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:20px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px) saturate(120%);
      border:1px solid rgba(255,255,255,0.04);
    }

    .brand{
      display:flex;gap:12px;align-items:center;margin-bottom:12px
    }
    .logo{
      width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:grid;place-items:center;font-weight:700;box-shadow:0 6px 20px rgba(124,92,255,0.18), inset 0 -6px 20px rgba(255,255,255,0.03);
    }
    .brand h1{font-size:14px;margin:0}
    .brand p{font-size:12px;margin:0;color:var(--muted)}

    .screen{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;padding:14px;min-height:84px;display:flex;flex-direction:column;justify-content:center;align-items:flex-end;
      gap:6px;margin-bottom:14px;border:1px solid var(--glass-2);
    }
    .screen .expression{font-size:16px;color:rgba(230,238,248,0.6);word-break:break-all}
    .screen .result{font-size:28px;font-weight:600}

    .pad{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
    button.key{
      border:0;padding:16px;border-radius:10px;font-size:16px;cursor:pointer;box-shadow:0 6px 18px rgba(2,6,23,0.6);transition:transform .12s ease, box-shadow .12s ease;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.03);
    }
    button.key:active{transform:translateY(2px)}

    button.op{background:linear-gradient(180deg, rgba(124,92,255,0.18), rgba(124,92,255,0.1));color:white;border:1px solid rgba(124,92,255,0.18)}
    button.equal{grid-column:span 2;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#06121a;font-weight:700;font-size:18px}
    button.fn{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:var(--muted)}
    button.clear{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:var(--danger);border:1px solid rgba(255,107,107,0.12)}

    .help{margin-top:10px;font-size:12px;color:var(--muted);display:flex;justify-content:space-between}
    .small{opacity:0.85}

    /* responsive */
    @media (max-width:420px){
      .wrap{width:94vw;padding:16px}
      .screen .result{font-size:24px}
      button.key{padding:12px}
    }
  </style>
</head>
<body>
  <main class="wrap" role="application" aria-label="Calculator">
   
    </div>

    <section class="screen" id="screen">
      <div class="expression" id="expression" aria-hidden="true">0</div>
      <div class="result" id="result">0</div>
    </section>

    <section class="pad" role="group" aria-label="Calculator keypad">
      <button class="key fn clear" data-action="clear" title="Clear (Esc)">C</button>
      <button class="key fn" data-action="back" title="Backspace (Backspace)">⌫</button>
      <button class="key fn" data-value="%" title="Percent">%</button>
      <button class="key op" data-value="/">÷</button>

      <button class="key" data-value="7">7</button>
      <button class="key" data-value="8">8</button>
      <button class="key" data-value="9">9</button>
      <button class="key op" data-value="*">×</button>

      <button class="key" data-value="4">4</button>
      <button class="key" data-value="5">5</button>
      <button class="key" data-value="6">6</button>
      <button class="key op" data-value="-">−</button>

      <button class="key" data-value="1">1</button>
      <button class="key" data-value="2">2</button>
      <button class="key" data-value="3">3</button>
      <button class="key op" data-value="+">+</button>

      <button class="key" data-value="0" style="grid-column:span 2;">0</button>
      <button class="key" data-value="." title="Decimal">.</button>
      <button class="key equal" data-action="equals" title="Equals (Enter)">=</button>
    </section>

   
  </main>

  <script>
    (function(){
      const expressionEl = document.getElementById('expression');
      const resultEl = document.getElementById('result');
      let expr = '';

      function updateScreen(){
        expressionEl.textContent = expr || '0';
        try{
          const safe = toJS(expr);
          resultEl.textContent = safe === '' ? '0' : safe;
        }catch(e){
          resultEl.textContent = '0';
        }
      }

      // Convert our user friendly operators to JS and evaluate safely
      function toJS(input){
        if(!input) return '';
        // Replace × ÷ − with JS equivalents
        let s = input.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-');
        // handle percent: convert e.g. "50%" -> "(50/100)" and "200+10%" -> "200 + (10/100)"
        s = s.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
        // remove leading zeros in multi-digit numbers (but keep 0.x)
        // Basic safety: prohibit letters
        if(/[A-Za-z]/.test(s)) throw new Error('Invalid');
        // Disallow double operators except - for negative
        s = s.replace(/([^0-9\.\)\%])\+/g,'$1+');
        // Evaluate with Function to avoid eval (still similar) but we keep simple
        // Prevent injection by only allowing digits, operators, parentheses and dots
        if(!/^[0-9+\-*/().\s]+$/.test(s)) throw new Error('Invalid chars');
        // Evaluate
        const val = Function('return ' + s)();
        if(!isFinite(val)) throw new Error('Math error');
        // Format nicely
        return Number(Math.round((val + Number.EPSILON) * 1e12) / 1e12).toString();
      }

      // Button clicks
      document.querySelectorAll('button.key').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const v = btn.getAttribute('data-value');
          const action = btn.getAttribute('data-action');
          if(action === 'clear') return clearAll();
          if(action === 'back') return back();
          if(action === 'equals') return compute();
          if(v) append(v);
        })
      });

      function append(val){
        // Prevent starting with an operator except minus
        if(expr === '' && /[+*/]/.test(val)) return;
        // prevent multiple dots in a number
        if(val === '.'){
          // find last number
          const m = expr.match(/(\d*\.?\d*)$/);
          if(m && m[0].includes('.')) return;
        }
        expr += val;
        updateScreen();
      }

      function clearAll(){ expr=''; updateScreen(); }
      function back(){ expr = expr.slice(0,-1); updateScreen(); }
      function compute(){
        try{
          const out = toJS(expr);
          expr = out.toString();
          updateScreen();
        }catch(e){
          resultEl.textContent = 'Error';
        }
      }

      // Keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9') { append(e.key); e.preventDefault(); return }
        if(['+','-','*','/','.','%'].includes(e.key)){ append(e.key); e.preventDefault(); return }
        if(e.key === 'Enter') { compute(); e.preventDefault(); return }
        if(e.key === 'Backspace') { back(); e.preventDefault(); return }
        if(e.key === 'Escape') { clearAll(); e.preventDefault(); return }
      });

      // initial
      updateScreen();

    })();
  </script>
</body>
</html>
